SELECT
  *
FROM
  idpdm.apo_frcst_wk_fct
WHERE
  FRCST_VERS_DATE IN (
    SELECT
      MAX(FRCST_VERS_DATE)
    FROM
      idpdm.apo_frcst_wk_fct
  )
  AND TP_END_DATE <= date_format(current_date(), 'yyyyMMdd')
  AND TP_END_DATE >= date_format(
    date_sub(current_date(), day(current_date()) - 1),
    'yyyyMMdd'
  )
  AND FILE_SUB_REGN_NAME = 'EU'
  AND ORG_CODE = 'R'
  AND PROD_ID IN (
    SELECT
      distinct PROD_ID
    FROM
      idpdm.MD_PROD_9005_DAY_FDIM
    WHERE
      PROD_4_NAME IN (
        'AIR',
        'CLEANPROD',
        'CLEANSYS',
        'AUTODISH',
        'HANDDISH'
      )
  )
