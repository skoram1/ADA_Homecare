SELECT 
    FROM_UNIXTIME(UNIX_TIMESTAMP(CAST(FRCST_VERS_DATE AS STRING),'yyyyMMdd')) AS FRCST_VERS_DATE, 
    FINAL_FRCST_NORM_QTY,
    PROD_ID, 
    CNTRY_CLSTR_CODE, 
    FROM_UNIXTIME(UNIX_TIMESTAMP(CAST(TP_END_DATE AS STRING),'yyyyMMdd')) AS TP_END_DATE
FROM IDPDM.APO_FRCST_WK_FCT
WHERE 
    FRCST_VERS_DATE >= 20220601
    AND FROM_UNIXTIME(UNIX_TIMESTAMP(CAST(TP_END_DATE AS STRING), 'yyyyMMdd')) <= FROM_UNIXTIME(UNIX_TIMESTAMP(DATE_ADD(FROM_UNIXTIME(UNIX_TIMESTAMP(CAST(FRCST_VERS_DATE AS STRING), 'yyyyMMdd')), 62), 'yyyyMMdd')) 
    AND FILE_SUB_REGN_NAME = 'EU'
    AND ORG_CODE = 'R'
    AND PROD_ID IN (
        SELECT DISTINCT PROD_ID 
        FROM IDPDM.MD_PROD_9005_DAY_FDIM
        WHERE PROD_4_NAME IN ('AIR','CLEANPROD','CLEANSYS','AUTODISH','HANDDISH')
    );
